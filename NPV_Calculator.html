<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Net Present Value (NPV) Calculator</title>
    
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #0c0e14; color: #f4f6f7; }
        .container { max-width: 700px; margin: 0 auto; background: #1a1e2b; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        h1 { color: #f39c12; text-align: center; margin-bottom: 5px; }
        p { color: #aeb6bf; text-align: center; margin-bottom: 25px; }

        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #5dade2; font-weight: bold; }
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #3498db;
            border-radius: 5px;
            background-color: #2c3e50;
            color: #fff;
            font-size: 16px;
        }

        #cashflows-container div {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }

        .cashflow-label { 
            color: #aeb6bf; 
            font-size: 0.9em; 
            display: flex;
            align-items: center;
        }

        .output-box {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            background-color: #34495e;
            border: 2px solid #2ecc71;
        }

        .output-box h3 {
            margin-top: 0;
            color: #f39c12;
            border-bottom: 1px solid #f39c12;
            padding-bottom: 5px;
        }

        .output-box .value {
            font-size: 2.5em;
            color: #2ecc71;
            font-weight: bold;
            display: block;
        }
        
        .output-box .label {
            font-size: 0.9em;
            color: #aeb6bf;
            text-transform: uppercase;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background-color: #5dade2;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background-color 0.2s;
        }
        button:hover { background-color: #2980b9; }

        .note {
            margin-top: 20px;
            padding: 10px;
            background-color: #34495e;
            border-left: 5px solid #e74c3c;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>üí∞ Net Present Value (NPV)</h1>
    <p>Determine the current value of a future investment stream, factoring in the cost of capital.</p>

    <div class="input-group">
        <label for="initial-cost-input">Initial Investment Cost (C‚ÇÄ, Outflow $)</label>
        <input type="number" id="initial-cost-input" value="10000" min="0" oninput="calculateNPV()">
    </div>

    <div class="input-group">
        <label for="rate-input">Discount Rate (Required Rate of Return, %)</label>
        <input type="number" id="rate-input" value="10" min="0" step="0.1" oninput="calculateNPV()">
    </div>
    
    <div class="input-group">
        <label for="term-input">Investment Term (Years)</label>
        <input type="number" id="term-input" value="3" min="1" max="10" oninput="generateCashFlowInputs(); calculateNPV();">
    </div>

    <hr style="border-color:#3498db; margin: 30px 0;">

    <h3>Future Cash Flows (C‚ÇÅ to C‚Çú)</h3>
    <div id="cashflows-container">
        </div>
    <button onclick="generateCashFlowInputs(); calculateNPV();">Update Cash Flow Inputs</button>

    <div class="output-box">
        <h3>Net Present Value (NPV)</h3>
        <span class="value" id="npv-output">$0.00</span>
        <span class="label">If NPV > $0.00, the project is profitable.</span>
    </div>

    <div class="note">
        If NPV is positive, the project is expected to be profitable. If negative, it is expected to lose value.
    </div>
</div>

<script>
    const INITIAL_COST_INPUT = document.getElementById('initial-cost-input');
    const RATE_INPUT = document.getElementById('rate-input');
    const TERM_INPUT = document.getElementById('term-input');
    const CASHFLOWS_CONTAINER = document.getElementById('cashflows-container');
    const NPV_OUTPUT = document.getElementById('npv-output');

    const formatCurrency = (value) => '$' + value.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    // --- 1. Generate Input Fields Dynamically ---
    function generateCashFlowInputs() {
        const term = parseInt(TERM_INPUT.value);
        if (isNaN(term) || term < 1 || term > 10) return;

        // Save existing cash flow values to re-insert them
        const existingValues = [];
        for (let i = 1; i <= 10; i++) {
            const input = document.getElementById(`cf-year-${i}`);
            if (input) existingValues[i] = input.value;
        }

        CASHFLOWS_CONTAINER.innerHTML = ''; // Clear previous inputs

        for (let t = 1; t <= term; t++) {
            const div = document.createElement('div');
            
            // Label
            const label = document.createElement('span');
            label.className = 'cashflow-label';
            label.textContent = `Year ${t} Cash Flow (C${t}):`;
            div.appendChild(label);

            // Input
            const input = document.createElement('input');
            input.type = 'number';
            input.id = `cf-year-${t}`;
            input.placeholder = `Cash Flow Year ${t}`;
            input.oninput = calculateNPV;
            
            // Restore previous value or set default
            input.value = existingValues[t] !== undefined ? existingValues[t] : (t * 4000); 
            
            div.appendChild(input);
            CASHFLOWS_CONTAINER.appendChild(div);
        }
    }

    // --- 2. Core NPV Calculation ---
    function calculateNPV() {
        const C0 = parseFloat(INITIAL_COST_INPUT.value); // Initial Cost
        const r_percent = parseFloat(RATE_INPUT.value); // Discount Rate %
        const term = parseInt(TERM_INPUT.value);

        if (isNaN(C0) || C0 < 0 || isNaN(r_percent) || r_percent < 0 || isNaN(term) || term < 1) {
            NPV_OUTPUT.textContent = '$0.00';
            NPV_OUTPUT.style.color = '#2ecc71';
            return;
        }

        const r = r_percent / 100; // Rate as decimal
        let netPresentValue = -C0; // Start with negative initial cost

        // Sum the Present Value of Future Cash Flows
        for (let t = 1; t <= term; t++) {
            const input = document.getElementById(`cf-year-${t}`);
            const Ct = input ? parseFloat(input.value) : 0;
            
            if (isNaN(Ct)) continue;

            // Present Value (PV) = Ct / (1 + r)^t
            const presentValue = Ct / Math.pow((1 + r), t);
            
            netPresentValue += presentValue;
        }

        // --- Output Results ---
        
        NPV_OUTPUT.textContent = formatCurrency(netPresentValue);
        
        // Update color based on profitability
        if (netPresentValue > 0) {
            NPV_OUTPUT.style.color = '#2ecc71'; // Green (Profitable)
        } else if (netPresentValue < 0) {
            NPV_OUTPUT.style.color = '#e74c3c'; // Red (Loss)
        } else {
            NPV_OUTPUT.style.color = '#f39c12'; // Yellow (Break-even)
        }
    }

    // --- Initialization ---
    window.onload = function() {
        generateCashFlowInputs(); // Create default inputs
        calculateNPV(); // Run initial calculation
    };
</script>
</body>
</html>
