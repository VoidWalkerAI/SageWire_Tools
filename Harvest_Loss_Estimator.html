<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HerdMate | Harvest Loss Estimator</title>
    
    <style>
        /* --- HERDMATE BRANDING CSS --- */
        body { 
            font-family: sans-serif; 
            padding: 20px; 
            background-color: #14141A; /* Ranch Slate */
            color: #f4f6f7; 
            font-size: 1.05em;
        }
        .container { 
            max-width: 700px; 
            margin: 0 auto; 
            background: #292930; /* Soil/Dark Taupe */
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.5); 
        }
        h1 { 
            color: #B85C38; /* Primary Accent (Rust) */
            text-align: center; 
            margin-bottom: 5px; 
        }
        p { 
            color: #ccc; 
            text-align: center; 
            margin-bottom: 25px; 
        }

        .section-title {
            color: #5dade2;
            border-bottom: 1px solid #5dade2;
            padding-bottom: 5px;
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        label { display: block; margin-bottom: 8px; color: #aeb6bf; font-weight: bold; }
        
        input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 2px solid #7D716A; 
            border-radius: 5px;
            background-color: #34343d; 
            color: #fff;
            font-size: 16px;
        }

        .output-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }

        .output-box {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #E74C3C; /* Red for Loss */
            background-color: #34343d;
        }

        .output-box h3 {
            margin-top: 0;
            color: #B85C38; 
            border-bottom: 1px solid #7D716A;
            padding-bottom: 5px;
            font-size: 1.1em;
        }

        .output-box .value {
            font-size: 2em;
            color: #E74C3C; 
            font-weight: bold;
            display: block;
        }

        .output-box .label {
            font-size: 0.9em;
            color: #aeb6bf;
            text-transform: uppercase;
        }
        
        .total-loss-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #34343d;
            border-left: 5px solid #E74C3C;
            text-align: center;
        }
        
        .note {
            margin-top: 20px;
            padding: 10px;
            background-color: #34343d;
            border-left: 5px solid #5A946E;
            font-size: 0.9em;
            color: #f4f6f7;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>ðŸšœ HerdMate | Harvest Loss</h1>
    <p>Calculate bushels lost per acre and total revenue left in the field.</p>

    <div class="input-grid">
        <div>
            <label for="crop-select">Crop Type</label>
            <select id="crop-select" onchange="calculateLoss()">
                <option value="2">Corn (2 kernels/sq ft = 1 bu)</option>
                <option value="4" selected>Soybeans (4 beans/sq ft = 1 bu)</option>
                <option value="18">Wheat (18 seeds/sq ft = 1 bu)</option>
                <option value="11">Sorghum/Milo (11 seeds/sq ft = 1 bu)</option>
            </select>
        </div>
        <div>
            <label for="market-price">Market Price ($/Bu)</label>
            <input type="number" id="market-price" value="12.50" step="0.01" oninput="calculateLoss()">
        </div>
    </div>

    <h3 class="section-title">Field Sample Data</h3>
    <label for="seed-count">Seeds Counted (In 1 Sq. Foot Box)</label>
    <input type="number" id="seed-count" value="8" min="0" oninput="calculateLoss()">
    
    <div class="input-grid" style="margin-top:15px;">
        <div>
            <label for="header-width">Header Width (Feet)</label>
            <input type="number" id="header-width" value="30" min="1" oninput="calculateLoss()">
        </div>
        <div>
            <label for="spread-width">Discharge/Spread Width (Feet)</label>
            <input type="number" id="spread-width" value="30" min="1" placeholder="Same as header if not windrowing" oninput="calculateLoss()">
        </div>
    </div>

    <div class="output-grid">
        <div class="output-box">
            <h3>Yield Loss</h3>
            <span class="value" id="loss-bu-output">0.0 Bu/A</span>
            <span class="label">Bushels Per Acre</span>
        </div>
        <div class="output-box">
            <h3>Revenue Loss</h3>
            <span class="value" id="loss-money-output">$0.00</span>
            <span class="label">Lost Per Acre</span>
        </div>
    </div>
    
    <h3 class="section-title" style="margin-top:30px;">Total Field Impact (Optional)</h3>
    <label for="field-acres">Field Size (Acres)</label>
    <input type="number" id="field-acres" placeholder="Enter acres to see total loss" oninput="calculateLoss()">
    
    <div class="total-loss-box">
        <span style="color:#aeb6bf; font-weight:bold; display:block; margin-bottom:5px;">TOTAL FIELD LOSS</span>
        <span id="total-field-loss" style="font-size: 2.2em; color: #E74C3C; font-weight: bold;">$0.00</span>
    </div>

    <div class="note">
        <strong>Concentration Factor:</strong> If you count seeds in the discharge strip (behind the machine) and your spreader doesn't cover the full header width, this calculator automatically adjusts the count to find the true average loss across the field.
    </div>
</div>

<script>
    const CROP_SELECT = document.getElementById('crop-select');
    const PRICE_INPUT = document.getElementById('market-price');
    const SEED_COUNT_INPUT = document.getElementById('seed-count');
    const HEADER_WIDTH_INPUT = document.getElementById('header-width');
    const SPREAD_WIDTH_INPUT = document.getElementById('spread-width');
    const FIELD_ACRES_INPUT = document.getElementById('field-acres');
    
    const LOSS_BU_OUTPUT = document.getElementById('loss-bu-output');
    const LOSS_MONEY_OUTPUT = document.getElementById('loss-money-output');
    const TOTAL_FIELD_LOSS = document.getElementById('total-field-loss');

    const formatCurrency = (value) => '$' + value.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");

    function calculateLoss() {
        // Get input values
        const seedsPerBu = parseFloat(CROP_SELECT.value); // The divisor constant
        const price = parseFloat(PRICE_INPUT.value);
        const count = parseFloat(SEED_COUNT_INPUT.value);
        const headerW = parseFloat(HEADER_WIDTH_INPUT.value);
        const spreadW = parseFloat(SPREAD_WIDTH_INPUT.value);
        const acres = parseFloat(FIELD_ACRES_INPUT.value);

        // Validation
        if (isNaN(price) || isNaN(count) || isNaN(headerW) || isNaN(spreadW) || 
            price < 0 || count < 0 || headerW <= 0 || spreadW <= 0) {
            LOSS_BU_OUTPUT.textContent = '0.0 Bu/A';
            LOSS_MONEY_OUTPUT.textContent = '$0.00';
            TOTAL_FIELD_LOSS.textContent = '$0.00';
            return;
        }

        // 1. Calculate Concentration Factor
        // If spread width equals header width, factor is 1 (no concentration).
        // If spread is narrower (e.g., 10ft spread / 30ft header), seeds are 3x concentrated.
        // We need to DIVIDE the count by this factor to get the true field average.
        // Ratio = Spread / Header.  True Count = Count * Ratio.
        const concentrationRatio = spreadW / headerW;
        
        const adjustedCount = count * concentrationRatio;

        // 2. Calculate Bushel Loss Per Acre
        // Formula: Adjusted Count / Crop Constant
        const buLossPerAcre = adjustedCount / seedsPerBu;

        // 3. Calculate Financial Loss
        const moneyLossPerAcre = buLossPerAcre * price;

        // 4. Total Field Loss
        let totalFieldLoss = 0;
        if (!isNaN(acres) && acres > 0) {
            totalFieldLoss = moneyLossPerAcre * acres;
        }

        // --- Output Results ---
        
        LOSS_BU_OUTPUT.textContent = buLossPerAcre.toFixed(2) + " Bu/A";
        LOSS_MONEY_OUTPUT.textContent = formatCurrency(moneyLossPerAcre);
        TOTAL_FIELD_LOSS.textContent = formatCurrency(totalFieldLoss);
    }

    // Initialize
    window.onload = function() {
        calculateLoss();
    };
</script>
</body>
</html>
